<!doctype html>
<html>
<head><meta charset='utf-8'><title>Round 1 | Hidden Art Hunt</title></head>
<body>
<h2>Round 1 – External Drive Challenges</h2>
<p>Solve any <b>2</b> challenges to qualify.</p>

<div id='qset'></div>
<div id='next' style='display:none;margin-top:20px;'>
  <input id='team' placeholder='Team Name'>
  <button onclick='getCode()'>Get Round 1 Code</button>
  <p id='code'></p>
</div>

<script>
const FUNC_BASE='/.netlify/functions';
const challenges=[
 {id:1,link:'https://drive.google.com/file/CHALLENGE1'},
 {id:2,link:'https://drive.google.com/file/CHALLENGE2'},
 {id:3,link:'https://drive.google.com/file/CHALLENGE3'},
 {id:4,link:'https://drive.google.com/file/CHALLENGE4'}
];
const el=document.getElementById('qset');
challenges.forEach(c=>{
  el.innerHTML+=\
  <div>
    <a href='\' target='_blank'>Open Challenge \</a>
    <input id='a\' placeholder='Enter answer'>
    <button onclick='submit(\)'>Submit</button>
    <span id='m\'></span>
  </div><br>\;
});

async function submit(i){
  const team=prompt('Team Name?');
  const ans=document.getElementById('a'+i).value;
  if(!ans)return alert('Enter answer');
  const r=await fetch(FUNC_BASE+'/verifyAnswer',{method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({teamName:team,round:'round1',index:i,answer:ans})});
  const j=await r.json();
  document.getElementById('m'+i).textContent=j.correct?'✔ Correct':'✖ Wrong';
  if(j.passed)document.getElementById('next').style.display='block';
}
async function getCode(){
  const team=document.getElementById('team').value.trim();
  if(!team)return alert('Enter team name');
  const r=await fetch(FUNC_BASE+'/assignCode',{method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({teamName:team,round:'round1'})});
  const j=await r.json();
  document.getElementById('code').textContent=j.code?('Your Code: '+j.code):'Error';
}
</script>
</body>
</html>
